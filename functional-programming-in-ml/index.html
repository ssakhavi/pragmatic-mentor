<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Functional Frameworks in Machine Learning - The Pragmatic Mentor</title><meta name=Description content="My Journey towards Becoming a Better Mentor"><meta property="og:title" content="Functional Frameworks in Machine Learning"><meta property="og:description" content="This is my conversation with OpenAI&rsquo;s ChatGPT. I want to clarify I have no intention of using this technology for monotization. I&rsquo;ve used it for generating knowledge and nothing else.
Functional Frameworks Are a Thing Q: I&rsquo;ve been noticing machine learning frameworks such as JAX and functorch have been adopting functional programming paradigms. Is this true?
Yes, it&rsquo;s true that some machine learning frameworks are adopting functional programming paradigms. This is because functional programming can help make it easier to write code that is concise, modular, and reusable, which can be useful when working on large machine learning projects."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.siavashsakhavi.com/functional-programming-in-ml/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-12-02T10:50:57+08:00"><meta property="article:modified_time" content="2022-12-02T11:58:11+08:00"><meta property="og:site_name" content="The Pragmatic Mentor"><meta name=twitter:card content="summary"><meta name=twitter:title content="Functional Frameworks in Machine Learning"><meta name=twitter:description content="This is my conversation with OpenAI&rsquo;s ChatGPT. I want to clarify I have no intention of using this technology for monotization. I&rsquo;ve used it for generating knowledge and nothing else.
Functional Frameworks Are a Thing Q: I&rsquo;ve been noticing machine learning frameworks such as JAX and functorch have been adopting functional programming paradigms. Is this true?
Yes, it&rsquo;s true that some machine learning frameworks are adopting functional programming paradigms. This is because functional programming can help make it easier to write code that is concise, modular, and reusable, which can be useful when working on large machine learning projects."><meta name=application-name content="The Pragmatic Mentor"><meta name=apple-mobile-web-app-title content="The Pragmatic Mentor"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.siavashsakhavi.com/functional-programming-in-ml/><link rel=prev href=https://blog.siavashsakhavi.com/information-proc-org-rec/><link rel=next href=https://blog.siavashsakhavi.com/mlaas-vs-mlops/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Functional Frameworks in Machine Learning","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.siavashsakhavi.com\/functional-programming-in-ml\/"},"image":["https:\/\/blog.siavashsakhavi.com\/images\/Apple-Devices-Preview.png"],"genre":"posts","keywords":"Functorch, JAX, ChatGPT, OpenAI","wordcount":1574,"url":"https:\/\/blog.siavashsakhavi.com\/functional-programming-in-ml\/","datePublished":"2022-12-02T10:50:57+08:00","dateModified":"2022-12-02T11:58:11+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"xxxx"},"author":{"@type":"Person","name":"Siavash Sakhavi"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="The Pragmatic Mentor">The Pragmatic Mentor</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/>About </a><a class=menu-item href=https://github.com/ssakhavi title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw' aria-hidden=true></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="The Pragmatic Mentor">The Pragmatic Mentor</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/about/ title>About</a><a class=menu-item href=https://github.com/ssakhavi title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw' aria-hidden=true></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Functional Frameworks in Machine Learning</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Siavash Sakhavi</a></span>&nbsp;<span class=post-category>included in <a href=/categories/machine-learning/><i class="far fa-folder fa-fw" aria-hidden=true></i>Machine Learning</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-12-02>2022-12-02</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1574 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;8 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#functional-frameworks-are-a-thing>Functional Frameworks Are a Thing</a></li><li><a href=#what-are-per-sample-gradients>What Are Per Sample Gradients?</a></li><li><a href=#why-would-i-want-to-use-these-frameworks>Why Would I Want to Use These Frameworks?</a></li><li><a href=#can-you-give-me-an-example>Can You Give Me an Example?</a></li><li><a href=#a-more-complicated-example>A More Complicated Example</a></li><li><a href=#making-my-conversation-into-a-blog-post>Making My Conversation into a Blog Post?</a></li></ul></nav></div></div><div class=content id=content><p><strong>This is my conversation with OpenAI&rsquo;s ChatGPT</strong>. I want to clarify I have no intention of using this technology for monotization. I&rsquo;ve used it for generating knowledge and nothing else.</p><h2 id=functional-frameworks-are-a-thing>Functional Frameworks Are a Thing</h2><blockquote><p>Q: I&rsquo;ve been noticing machine learning frameworks such as JAX and functorch have been adopting functional programming paradigms. Is this true?</p></blockquote><p>Yes, it&rsquo;s true that some machine learning frameworks are adopting functional programming paradigms. This is because functional programming can help make it easier to write code that is concise, modular, and reusable, which can be useful when working on large machine learning projects. Additionally, functional programming can help make it easier to parallelize code and perform automatic differentiation, which are important capabilities for many machine learning tasks.</p><p>JAX, for example, is a functional programming framework for machine learning that is built on top of the popular NumPy library. It allows users to write code using functions and automatic differentiation, and it can run on GPUs and other hardware accelerators.</p><p>Functorch is another example of a machine learning framework that uses functional programming. It is built on top of the popular PyTorch library and allows users to write code using functional programming constructs.</p><p>Overall, the use of functional programming in machine learning is still relatively new, but it is gaining traction as a way to improve the efficiency and modularity of machine learning code.</p><h2 id=what-are-per-sample-gradients>What Are Per Sample Gradients?</h2><blockquote><p>Q: What is per sample gradients and why do these frameworks help with the computation of per sample gradients?</p></blockquote><p>Per-sample gradients are gradients that are calculated for each individual sample in a dataset, rather than for the entire dataset as a whole. This can be useful for tasks such as learning with very large datasets, where it may not be possible to calculate gradients for the entire dataset at once.</p><p>Some machine learning frameworks, such as JAX and Functorch, are designed to make it easier to calculate per-sample gradients. These frameworks typically use functional programming constructs, such as higher-order functions and automatic differentiation, to allow users to write code that can calculate gradients for individual samples in a concise and modular way.</p><p>For example, in JAX, users can write a function that calculates the gradient of a model&rsquo;s output with respect to its inputs, and then use this function to calculate the gradient for each sample in a dataset. This can be done in a parallelized and efficient manner, which can make it much easier to work with large datasets.</p><p>In general, the ability to calculate per-sample gradients can be important for many machine learning tasks, and frameworks like JAX and Functorch can make it easier to do so.</p><h2 id=why-would-i-want-to-use-these-frameworks>Why Would I Want to Use These Frameworks?</h2><blockquote><p>Q: For a person who is using Pytorch for training models, would they benefit in switching to Functorch?</p></blockquote><p>Whether a person who is using PyTorch for training models would benefit from switching to Functorch would depend on a number of factors, including their specific goals and the specific features of the two frameworks.</p><p>Functorch is a functional programming framework built on top of PyTorch, so it offers many of the same capabilities as PyTorch, such as support for deep learning and neural networks. However, Functorch also adds functional programming constructs, such as higher-order functions and automatic differentiation, which can make it easier to write concise, modular, and reusable code.</p><p>If a person is already familiar with PyTorch and is happy with the features and capabilities it offers, then switching to Functorch may not necessarily provide any significant benefits. However, if a person is looking for a way to improve the efficiency and modularity of their machine learning code, or if they are interested in using functional programming techniques in their work, then Functorch might be a good option to consider.</p><p>Ultimately, whether a person would benefit from switching from PyTorch to Functorch would depend on their specific needs and goals. It might be worth exploring both frameworks to see which one works best for a particular project or use case.</p><h2 id=can-you-give-me-an-example>Can You Give Me an Example?</h2><p>Here is an example of a simple machine learning model written in vanilla PyTorch:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>torch</span>  
</span></span><span class=line><span class=cl><span class=c1># Define a model with a single linear layer </span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>LinearModel</span><span class=p>(</span><span class=n>torch</span><span class=o>.</span><span class=n>nn</span><span class=o>.</span><span class=n>Module</span><span class=p>):</span>     
</span></span><span class=line><span class=cl>	<span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>input_size</span><span class=p>,</span> <span class=n>output_size</span><span class=p>):</span>         
</span></span><span class=line><span class=cl>		<span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>         
</span></span><span class=line><span class=cl>		<span class=bp>self</span><span class=o>.</span><span class=n>linear</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>input_size</span><span class=p>,</span> <span class=n>output_size</span><span class=p>)</span>          
</span></span><span class=line><span class=cl>	<span class=k>def</span> <span class=nf>forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>         
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>linear</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=c1># Create an instance of the model </span>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>LinearModel</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=c1># Generate some random input data </span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=c1># Use the model to make predictions on the input data </span>
</span></span><span class=line><span class=cl><span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=c1># Calculate the loss </span>
</span></span><span class=line><span class=cl><span class=n>loss</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>nn</span><span class=o>.</span><span class=n>functional</span><span class=o>.</span><span class=n>mse_loss</span><span class=p>(</span><span class=n>y_pred</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=c1># Backpropagate the loss to calculate the gradients </span>
</span></span><span class=line><span class=cl><span class=n>loss</span><span class=o>.</span><span class=n>backward</span><span class=p>()</span>  
</span></span><span class=line><span class=cl><span class=c1># Update the model parameters </span>
</span></span><span class=line><span class=cl><span class=n>optimizer</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>optim</span><span class=o>.</span><span class=n>SGD</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>parameters</span><span class=p>(),</span> <span class=n>lr</span><span class=o>=</span><span class=mf>0.01</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=n>optimizer</span><span class=o>.</span><span class=n>step</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>Here is the same model written using Functorch:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>functorch</span> <span class=k>as</span> <span class=nn>fc</span>  
</span></span><span class=line><span class=cl><span class=c1># Define a model with a single linear layer using Functorch&#39;s functional API</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>linear_model</span><span class=p>(</span><span class=n>input_size</span><span class=p>,</span> <span class=n>output_size</span><span class=p>):</span>     
</span></span><span class=line><span class=cl>	<span class=k>def</span> <span class=nf>forward</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>         
</span></span><span class=line><span class=cl>		<span class=n>linear</span> <span class=o>=</span> <span class=n>fc</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>input_size</span><span class=p>,</span> <span class=n>output_size</span><span class=p>)</span>         
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=n>linear</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>     
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=n>fc</span><span class=o>.</span><span class=n>Model</span><span class=p>(</span><span class=n>forward</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create an instance of the model</span>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>linear_model</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=c1># Generate some random input data </span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>fc</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=c1># Use the model to make predictions on the input data </span>
</span></span><span class=line><span class=cl><span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=c1># Calculate the loss </span>
</span></span><span class=line><span class=cl><span class=n>loss</span> <span class=o>=</span> <span class=n>fc</span><span class=o>.</span><span class=n>mse_loss</span><span class=p>(</span><span class=n>y_pred</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=c1># Backpropagate the loss to calculate the gradients </span>
</span></span><span class=line><span class=cl><span class=n>loss</span><span class=o>.</span><span class=n>backward</span><span class=p>()</span>  
</span></span><span class=line><span class=cl><span class=c1># Update the model parameters </span>
</span></span><span class=line><span class=cl><span class=n>optimizer</span> <span class=o>=</span> <span class=n>fc</span><span class=o>.</span><span class=n>SGD</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>parameters</span><span class=p>(),</span> <span class=n>lr</span><span class=o>=</span><span class=mf>0.01</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=n>optimizer</span><span class=o>.</span><span class=n>step</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>In this example, the model is defined using Functorch&rsquo;s functional API, which allows us to write the model as a function that takes inputs and returns outputs. This can make the code more concise and easier to read than the PyTorch version, which uses object-oriented programming. Additionally, Functorch automatically calculates gradients and performs backpropagation when <code>loss.backward()</code> is called, which can make the code even simpler and more modular.</p><h2 id=a-more-complicated-example>A More Complicated Example</h2><p>Sure, here is a more complicated example of a machine learning model written using Functorch:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>functorch</span> <span class=k>as</span> <span class=nn>fc</span>  
</span></span><span class=line><span class=cl><span class=c1># Define a convolutional neural network using Functorch&#39;s functional API </span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>convnet</span><span class=p>(</span><span class=n>input_size</span><span class=p>,</span> <span class=n>num_classes</span><span class=p>):</span>     
</span></span><span class=line><span class=cl>	<span class=k>def</span> <span class=nf>forward</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>         
</span></span><span class=line><span class=cl>		<span class=c1># Apply a sequence of convolutional and pooling layers         </span>
</span></span><span class=line><span class=cl>		<span class=n>x</span> <span class=o>=</span> <span class=n>fc</span><span class=o>.</span><span class=n>Conv2d</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=n>kernel_size</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>padding</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>         
</span></span><span class=line><span class=cl>		<span class=n>x</span> <span class=o>=</span> <span class=n>fc</span><span class=o>.</span><span class=n>ReLU</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>         
</span></span><span class=line><span class=cl>		<span class=n>x</span> <span class=o>=</span> <span class=n>fc</span><span class=o>.</span><span class=n>MaxPool2d</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>kernel_size</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>         
</span></span><span class=line><span class=cl>		<span class=n>x</span> <span class=o>=</span> <span class=n>fc</span><span class=o>.</span><span class=n>Conv2d</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=mi>64</span><span class=p>,</span> <span class=n>kernel_size</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>padding</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>         
</span></span><span class=line><span class=cl>		<span class=n>x</span> <span class=o>=</span> <span class=n>fc</span><span class=o>.</span><span class=n>ReLU</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>         
</span></span><span class=line><span class=cl>		<span class=n>x</span> <span class=o>=</span> <span class=n>fc</span><span class=o>.</span><span class=n>MaxPool2d</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>kernel_size</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>          
</span></span><span class=line><span class=cl>		<span class=c1># Flatten the output of the convolutional layers         </span>
</span></span><span class=line><span class=cl>		<span class=n>x</span> <span class=o>=</span> <span class=n>x</span><span class=o>.</span><span class=n>view</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>size</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span>          
</span></span><span class=line><span class=cl>		<span class=c1># Apply a sequence of fully-connected layers         </span>
</span></span><span class=line><span class=cl>		<span class=n>x</span> <span class=o>=</span> <span class=n>fc</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=mi>512</span><span class=p>)</span>         
</span></span><span class=line><span class=cl>		<span class=n>x</span> <span class=o>=</span> <span class=n>fc</span><span class=o>.</span><span class=n>ReLU</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>         
</span></span><span class=line><span class=cl>		<span class=n>x</span> <span class=o>=</span> <span class=n>fc</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>num_classes</span><span class=p>)</span>          
</span></span><span class=line><span class=cl>		<span class=c1># Return the logits         </span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=n>x</span>      
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=n>fc</span><span class=o>.</span><span class=n>Model</span><span class=p>(</span><span class=n>forward</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=c1># Create an instance of the model </span>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>convnet</span><span class=p>(</span><span class=n>input_size</span><span class=o>=</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>32</span><span class=p>),</span> <span class=n>num_classes</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=c1># Generate some random input data </span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>fc</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>32</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=c1># Use the model to make predictions on the input data </span>
</span></span><span class=line><span class=cl><span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=c1># Calculate the loss </span>
</span></span><span class=line><span class=cl><span class=n>loss</span> <span class=o>=</span> <span class=n>fc</span><span class=o>.</span><span class=n>cross_entropy_loss</span><span class=p>(</span><span class=n>y_pred</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>  
</span></span><span class=line><span class=cl><span class=c1># Backpropagate the loss to calculate the gradients </span>
</span></span><span class=line><span class=cl><span class=n>loss</span><span class=o>.</span><span class=n>backward</span><span class=p>()</span>  
</span></span><span class=line><span class=cl><span class=c1># Update the model parameters </span>
</span></span><span class=line><span class=cl><span class=n>optimizer</span> <span class=o>=</span> <span class=n>fc</span><span class=o>.</span><span class=n>SGD</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>parameters</span><span class=p>(),</span> <span class=n>lr</span><span class=o>=</span><span class=mf>0.01</span><span class=p>)</span> <span class=n>optimizer</span><span class=o>.</span><span class=n>step</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>In this example, we define a convolutional neural network using Functorch&rsquo;s functional API. This allows us to write the model as a function that takes inputs and returns outputs, and it allows us to use functional programming constructs such as higher-order functions and automatic differentiation. This can make the code more concise and easier to read than if we were to define the model using object-oriented programming, as we would have to do in PyTorch.</p><p>Additionally, Functorch automatically calculates gradients and performs backpropagation when <code>loss.backward()</code> is called, which can make the code even simpler and more modular. This can be particularly useful when working with complex neural network architectures, as it can help reduce the amount of boilerplate code that needs to be written.</p><h2 id=making-my-conversation-into-a-blog-post>Making My Conversation into a Blog Post?</h2><blockquote><p>Q: How would our conversation until here look like as a blog post?</p></blockquote><p>Here is an example of how our conversation until now could be written as a blog post:</p><p><strong>Title: Functional Programming in Machine Learning: An Introduction to Functorch and JAX</strong></p><p>Functional programming is a programming paradigm that focuses on the use of functions to model computations and data. In recent years, functional programming has been gaining popularity in the machine learning community, with some frameworks, such as Functorch and JAX, adopting functional programming paradigms.</p><p>Functorch is a functional programming framework built on top of PyTorch, a popular deep learning library. It allows users to write code using functional programming constructs, such as higher-order functions and automatic differentiation, which can make it easier to write concise, modular, and reusable code.</p><p>JAX is another functional programming framework for machine learning, built on top of the NumPy library. Like Functorch, it allows users to write code using functional programming constructs and to perform automatic differentiation. Additionally, JAX can run on GPUs and other hardware accelerators, which can make it easier to scale up machine learning code and work with large datasets.</p><p>The use of functional programming in machine learning is still relatively new, but it is gaining traction as a way to improve the efficiency and modularity of machine learning code. If you are interested in functional programming and machine learning, then learning about Functorch and JAX could be a useful addition to your skillset.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-12-02</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/functional-programming-in-ml/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://blog.siavashsakhavi.com/functional-programming-in-ml/ data-title="Functional Frameworks in Machine Learning" data-hashtags=Functorch,JAX,ChatGPT,OpenAI><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://blog.siavashsakhavi.com/functional-programming-in-ml/ data-hashtag=Functorch><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://blog.siavashsakhavi.com/functional-programming-in-ml/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/functorch/>Functorch</a>,&nbsp;<a href=/tags/jax/>JAX</a>,&nbsp;<a href=/tags/chatgpt/>ChatGPT</a>,&nbsp;<a href=/tags/openai/>OpenAI</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/information-proc-org-rec/ class=prev rel=prev title="Information- Processing, Organization and Retrieval"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Information- Processing, Organization and Retrieval</a>
<a href=/mlaas-vs-mlops/ class=next rel=next title="MLaaS vs MLOps">MLaaS vs MLOps<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.110.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2019 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Siavash Sakhavi</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>